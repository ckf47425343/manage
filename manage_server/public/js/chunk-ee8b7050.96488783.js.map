{"version":3,"sources":["webpack:///./src/views/PostProduct.vue?1237","webpack:///src/views/PostProduct.vue","webpack:///./src/views/PostProduct.vue?f0e6","webpack:///./src/views/PostProduct.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","ref","attrs","ruleForm","rules","model","value","callback","$$v","$set","expression","_l","item","key","id","title","typeId","img","on","$event","uploadVal","detail_img","slot","postProduct","staticRenderFns","name","created","pid","getProductById","getTypeData","console","log","$route","data","productType","type_id","price","status","save_count","desc","copyRuleForm","types","imgType","detailImgType","type","methods","axios","method","url","baseUrl","validfomat","reg","test","Error","$refs","formName","validate","valid","post","update","e","base64","params","headers","token","document","cookie","components","UploadFile","component"],"mappings":"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","file":"js/chunk-ee8b7050.96488783.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"postform\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"发布商品\")]),_c('div',{staticClass:\"postform_content\"},[_c('el-form',{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.ruleForm,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"商品名称\",\"prop\":\"name\"}},[_c('el-input',{attrs:{\"placeholder\":\"请你输入商品\"},model:{value:(_vm.ruleForm.name),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"name\", $$v)},expression:\"ruleForm.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"商品类型\",\"prop\":\"type_id\"}},[_c('el-select',{attrs:{\"placeholder\":\"请你选择商品类型\"},model:{value:(_vm.ruleForm.type_id),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"type_id\", $$v)},expression:\"ruleForm.type_id\"}},_vm._l((_vm.productType),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.title,\"value\":item.typeId}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"商品图片\",\"prop\":\"img\"}},[_c('UploadFile',{attrs:{\"img-src\":_vm.ruleForm.img},on:{\"upload\":function($event){return _vm.uploadVal($event, 'img')}}})],1),_c('el-form-item',{attrs:{\"label\":\"详情图片\",\"prop\":\"detail_img\"}},[_c('UploadFile',{attrs:{\"img-src\":_vm.ruleForm.detail_img},on:{\"upload\":function($event){return _vm.uploadVal($event, 'detail_img')}}})],1),_c('el-form-item',{attrs:{\"label\":\"商品价钱\",\"prop\":\"price\"}},[_c('el-input',{staticClass:\"price_input\",attrs:{\"placeholder\":\"请你输入商品价格\"},model:{value:(_vm.ruleForm.price),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"price\", $$v)},expression:\"ruleForm.price\"}},[_c('template',{slot:\"append\"},[_vm._v(\"元/斤\")])],2)],1),_c('el-form-item',{attrs:{\"label\":\"库存量\",\"prop\":\"save_count\"}},[_c('el-input',{staticClass:\"price_input\",attrs:{\"placeholder\":\"请输入库存总量\"},model:{value:(_vm.ruleForm.save_count),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"save_count\", $$v)},expression:\"ruleForm.save_count\"}})],1),_c('el-form-item',{attrs:{\"label\":\"商品状态\",\"prop\":\"status\"}},[_c('el-radio-group',{model:{value:(_vm.ruleForm.status),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"status\", $$v)},expression:\"ruleForm.status\"}},[_c('el-radio',{attrs:{\"label\":\"上架\"}}),_c('el-radio',{attrs:{\"label\":\"下架\"}})],1)],1),_c('el-form-item',{attrs:{\"label\":\"商品描述\",\"prop\":\"desc\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.ruleForm.desc),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"desc\", $$v)},expression:\"ruleForm.desc\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.postProduct('ruleForm')}}},[_vm._v(\"提交商品\")])],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"postform\">\r\n    <div class=\"title\">发布商品</div>\r\n    <div class=\"postform_content\">\r\n      <el-form\r\n        :model=\"ruleForm\"\r\n        :rules=\"rules\"\r\n        ref=\"ruleForm\"\r\n        label-width=\"100px\"\r\n        class=\"demo-ruleForm\"\r\n      >\r\n        <el-form-item label=\"商品名称\" prop=\"name\">\r\n          <el-input\r\n            v-model=\"ruleForm.name\"\r\n            placeholder=\"请你输入商品\"\r\n          ></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"商品类型\" prop=\"type_id\">\r\n          <el-select v-model=\"ruleForm.type_id\" placeholder=\"请你选择商品类型\">\r\n            <el-option\r\n              v-for=\"item in productType\"\r\n              :key=\"item.id\"\r\n              :label=\"item.title\"\r\n              :value=\"item.typeId\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"商品图片\" prop=\"img\">\r\n          <UploadFile\r\n            :img-src=\"ruleForm.img\"\r\n            @upload=\"uploadVal($event, 'img')\"\r\n          ></UploadFile>\r\n        </el-form-item>\r\n        <el-form-item label=\"详情图片\" prop=\"detail_img\">\r\n          <UploadFile\r\n            :img-src=\"ruleForm.detail_img\"\r\n            @upload=\"uploadVal($event, 'detail_img')\"\r\n          ></UploadFile>\r\n        </el-form-item>\r\n        <el-form-item label=\"商品价钱\" prop=\"price\">\r\n          <el-input\r\n            v-model=\"ruleForm.price\"\r\n            class=\"price_input\"\r\n            placeholder=\"请你输入商品价格\"\r\n          >\r\n          <template slot=\"append\">元/斤</template>\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"库存量\" prop=\"save_count\">\r\n          <el-input\r\n            v-model=\"ruleForm.save_count\"\r\n            class=\"price_input\"\r\n            placeholder=\"请输入库存总量\"\r\n          ></el-input>\r\n        </el-form-item>\r\n    \r\n        <el-form-item label=\"商品状态\" prop=\"status\">\r\n          <el-radio-group v-model=\"ruleForm.status\">\r\n            <el-radio label=\"上架\"></el-radio>\r\n            <el-radio label=\"下架\"></el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"商品描述\" prop=\"desc\">\r\n          <el-input type=\"textarea\" v-model=\"ruleForm.desc\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"postProduct('ruleForm')\"\r\n            >提交商品</el-button\r\n          >\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport \"../assets/less/post_form.less\";\r\nimport UploadFile from \"../components/UploadFile.vue\";\r\nexport default {\r\n  name: \"PostProduct\",\r\n  created() {\r\n    let pid = this.$route.query.pid;\r\n    if (pid) {\r\n      //获取pid\r\n      this.pid = pid;\r\n    \r\n      this.title = \"商品详情\";\r\n      //通过id查询商品\r\n      this.getProductById(pid);\r\n    } else {\r\n      this.title = \"发布商品\";\r\n    }\r\n    this.getTypeData();\r\n    console.log(\"query==>\", this.$route);\r\n  },\r\n  data() {\r\n    return {\r\n      \r\n      //标题\r\n      title: \"\",\r\n      //商品类型\r\n      productType: [],\r\n      //记录商品pid\r\n      pid: \"\",\r\n      ruleForm: {\r\n        name: \"\",\r\n        type_id: \"\",\r\n        price: \"\",\r\n        status: \"\",\r\n        save_count:\"\",\r\n        desc: \"\",\r\n        img: \"\",\r\n        detail_img: \"\",\r\n      },\r\n      //获取商品数据\r\n      copyRuleForm:{},\r\n      //图片类型\r\n      types: {\r\n        imgType: \"\",\r\n        detailImgType: \"\",\r\n      },\r\n      rules: {\r\n        name: [{ required: true, message: \"请输入活动名称\", trigger: \"blur\" }],\r\n        type: [\r\n          { required: true, message: \"请选择商品类型\", trigger: \"change\" },\r\n        ],\r\n        price: [\r\n          { validator: this.validfomat, required: true, trigger: \"change\" },\r\n        ],\r\n        img: [{ required: true, message: \"请上传图片\", trigger: \"change\" }],\r\n        detail_img: [\r\n          { required: true, message: \"请上传详情图片\", trigger: \"change\" },\r\n        ],\r\n        save_count:[{validator: this.validfomat, required: true,trigger: \"change\" }],\r\n        status: [\r\n          { required: true, message: \"请选择商品状态\", trigger: \"change\" },\r\n        ],\r\n        desc: [{ required: true, message: \"请填写活动形式\", trigger: \"blur\" }],\r\n      },\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    getTypeData() {\r\n      console.log(this);\r\n      this.axios({\r\n        method: \"GET\",\r\n        url: this.baseUrl + \"/type\",\r\n      })\r\n        .then((result) => {\r\n          console.log(\"res==>\", result);\r\n          if (result.data.status == 1050) {\r\n            this.productType = result.data.result;\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"err=>\", error);\r\n        });\r\n    },\r\n    validfomat(rule, value, callback) {\r\n      console.log(value,rule)\r\n      let reg = /(^[1-9]\\d*(\\.\\d{1,2})?$)|(^0(\\.\\d{1,2})?$)/;\r\n      if (!value) {\r\n           return  callback(new Error(\"不能为空\"));\r\n      }\r\n      console.log(reg.test(value));\r\n      if (!reg.test(value)) {\r\n        return callback(new Error(\"格式错误\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    },\r\n    postProduct(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          if (this.pid) {\r\n            this.update();\r\n          } else {\r\n            this.post();\r\n          }\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    post() {\r\n       let product=Object.assign({},this.ruleForm,this.types)\r\n          \r\n          product.img=product.img.replace(/data:image\\/[a-z]+;base64,/,'')\r\n          product.detail_img=product.detail_img.replace(/data:image\\/[a-z]+;base64,/,'')\r\n         \r\n         \r\n          this.axios({\r\n            method: \"POST\",\r\n            url: this.baseUrl + \"/postProduct\",\r\n            data: product,\r\n            headers: {\r\n              token: document.cookie,\r\n            },\r\n          })\r\n            .then((result) => {\r\n              \r\n              if(result.data.status==1034){\r\n              this.$message({\r\n                message:result.data.msg,\r\n                type:'error'\r\n              })\r\n              setTimeout(()=>{\r\n                this.$router.push({name:'Login'})\r\n              },1000)\r\n            }\r\n            if(result.data.status==1060){\r\n             \r\n               this.$message({\r\n                message:result.data.msg,\r\n                type:'success'\r\n              })\r\n              this.ruleForm={}\r\n            }\r\n            if(result.data.status==1061){\r\n                this.$message({\r\n                message:result.data.msg,\r\n                type:'error'\r\n              })\r\n            }\r\n            })\r\n            .catch((err) => {\r\n              console.log(err);\r\n            });\r\n    },\r\n    update(){\r\n      \r\n         let data={}\r\n          \r\n          for(let key in this.ruleForm){\r\n             if(!(this.ruleForm[key]==this.copyRuleForm[key])){\r\n                  data[key]=this.ruleForm[key]\r\n             }\r\n            }\r\n          if(data.img){\r\n             data.img=data.img.replace(/data:image\\/[a-z]+;base64,/,'')\r\n             data.imgType=this.types.imgType\r\n          }\r\n          if(data.detail_img){\r\n             data.detail_img=data.detail_img.replace(/data:image\\/[a-z]+;base64,/,'')\r\n             data.detailImgType=this.types.detailImgType\r\n \r\n          }\r\n\r\n\r\n       //商品没有更新就拦截\r\n        if(JSON.stringify(data)!=\"{}\"){\r\n           data.pid=this.pid\r\n        }else{\r\n         \r\n          return this.$message({\r\n              message: '你尚未更改商品信息',\r\n              type: 'warning'\r\n          })\r\n        }\r\n        \r\n          this.axios({\r\n            method: \"POST\",\r\n            url: this.baseUrl + \"/updateProduct\",\r\n            data,\r\n            headers: {\r\n              token: document.cookie,\r\n            },\r\n          })\r\n            .then((result) => {\r\n               \r\n              if(result.data.status==1034){\r\n              this.$message({\r\n                message:result.data.msg,\r\n                type:'error'\r\n              })\r\n              setTimeout(()=>{\r\n                this.$router.push({name:'Login'})\r\n              },1000)\r\n            }\r\n               if(result.data.status==1100){\r\n                 this.$message({\r\n                   message:result.data.msg,\r\n                   type:'success'\r\n                 })\r\n                 this.getProductById(this.pid);\r\n               }\r\n            })\r\n            .catch((error) => {\r\n              console.log(\"test\")\r\n             this.$message({\r\n               message:'商品更新失败',\r\n               type:'error'\r\n             })\r\n            });\r\n    },\r\n    uploadVal(e, type) {\r\n      console.log(\"type=>\", type);\r\n      console.log(\"e==>\", e);\r\n\r\n      if (type == \"img\") {\r\n        console.log(e.base64);\r\n        this.ruleForm.img = e.base64;\r\n        this.types.imgType = e.type;\r\n      } else {\r\n        this.ruleForm.detail_img = e.base64;\r\n        this.types.detailImgType = e.type;\r\n      }\r\n    },\r\n    getProductById(pid) {\r\n      this.axios({\r\n        method: \"GET\",\r\n        url: this.baseUrl + \"/probyid\",\r\n        params: {\r\n          pid,\r\n        },\r\n        headers: {\r\n          token: document.cookie,\r\n        },\r\n      })\r\n        .then((result) => {\r\n          console.log(\"result===>\", result.data);\r\n          if(result.data.status==1034){\r\n              this.$message({\r\n                message:result.data.msg,\r\n                type:'error'\r\n              })\r\n              setTimeout(()=>{\r\n                this.$router.push({name:'Login'})\r\n              },1000)\r\n            }\r\n\r\n          if (result.data.status == 1070) {\r\n            let url = result.data.url;\r\n            let data = result.data.result[0];\r\n            data.img = url + \"/\" + data.img;\r\n            data.detail_img = url + \"/\" + data.detail_img;\r\n            \r\n            for (let key in this.ruleForm) {\r\n              this.ruleForm[key] = data[key];\r\n            }\r\n          //把商品数据复制一份出来\r\n            this.copyRuleForm=Object.assign({},this.ruleForm)\r\n            console.log(\"data==>\", data);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error\", error);\r\n        });\r\n    },\r\n  },\r\n  components: {\r\n    UploadFile,\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PostProduct.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PostProduct.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PostProduct.vue?vue&type=template&id=6b545fd5&scoped=true&\"\nimport script from \"./PostProduct.vue?vue&type=script&lang=js&\"\nexport * from \"./PostProduct.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6b545fd5\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}